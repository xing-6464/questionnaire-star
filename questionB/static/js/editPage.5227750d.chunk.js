"use strict";(self.webpackChunkquestionnaire_star=self.webpackChunkquestionnaire_star||[]).push([[166],{85101:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Me});var i=t(72229),s=t(34842);const o="Edit_container__jhAcg",r="Edit_content-wrapper__6CN3s",c="Edit_content__-A+KC",a="Edit_left__edBL0",d="Edit_main__Riaox",l="Edit_canvas-wrapper__hXs8K",u="Edit_right__4fTIT";var p=t(51354),x=t(32253),j=t.n(x);const v="EditCanvas_canvas__9lVfF",h="EditCanvas_component-wrapper__j0KhO",A="EditCanvas_selected__4RhD6",_="EditCanvas_locked__HrMMd",m="EditCanvas_component__zQIrc";var C=t(41185),f=t(77597),E=t(96472),y=t(4196),P=t(6569),g=t(46838);function L(){const e=document.activeElement;return e===document.body||!(null===e||void 0===e||!e.matches('div[role="button"]'))}const k=function(){const e=(0,y.j)();(0,P.A)(["backspace","delete"],(()=>{L()&&e((0,f.Tg)())})),(0,P.A)(["ctrl.c","meta.c"],(()=>{L()&&e((0,f.Sk)())})),(0,P.A)(["ctrl.v","meta.v"],(()=>{L()&&e((0,f.F7)())})),(0,P.A)("uparrow",(()=>{L()&&e((0,f.p5)())})),(0,P.A)("downarrow",(()=>{L()&&e((0,f.t$)())})),(0,P.A)(["ctrl.z","meta.z"],(()=>{L()&&e(g.IE.undo())}),{exactMatch:!0}),(0,P.A)(["ctrl.shift.z","meta.shift.z"],(()=>{L()&&e(g.IE.redo())}))};var N=t(72691),I=t(4284),b=t(68705);const T=function(e){const{children:n,onDragEnd:t,items:i}=e,s=(0,N.FR)((0,N.MS)(N.cA,{activationConstraint:{distance:8}}));return(0,b.jsx)(N.Mp,{sensors:s,collisionDetection:N.fp,onDragEnd:function(e){const{active:n,over:s}=e;if(null!=s&&n.id!==s.id){const e=i.findIndex((e=>e.fe_id===n.id)),o=i.findIndex((e=>e.fe_id===s.id));t(e,o)}},children:(0,b.jsx)(I.gB,{items:i,strategy:I._G,children:n})})};var w=t(18256);const K=function(e){const{id:n,children:t}=e,{attributes:i,listeners:s,setNodeRef:o,transform:r,transition:c}=(0,I.gl)({id:n}),a={transform:w.Ks.Transform.toString(r),transition:c};return(0,b.jsx)("div",{ref:o,style:a,...i,...s,children:t})};function S(e){const{type:n,props:t}=e,i=(0,E.T)(n);if(null==i)return null;const{Component:s}=i;return(0,b.jsx)(s,{...t})}const H=function(e){const{loading:n}=e,{componentList:t,selectedId:i}=(0,C.A)(),s=(0,y.j)();if(k(),n)return(0,b.jsx)("div",{style:{textAlign:"center",marginTop:"24px"},children:(0,b.jsx)(p.A,{})});const o=t.map((e=>({...e,id:e.fe_id})));return(0,b.jsx)(T,{items:o,onDragEnd:function(e,n){s((0,f.pp)({oldIndex:e,newIndex:n}))},children:(0,b.jsx)("div",{className:v,children:t.filter((e=>!e.isHidden)).map((e=>{const{fe_id:n,isLocked:t}=e,o=h,r=A,c=_,a=j()({[o]:!0,[r]:n===i,[c]:t});return(0,b.jsx)(K,{id:n,children:(0,b.jsx)("div",{className:a,onClick:e=>{return t=n,e.stopPropagation(),void s((0,f.RC)(t));var t},children:(0,b.jsx)("div",{className:m,children:S(e)})})},n)}))})})};var R=t(57767),z=t(90264),O=t(44168),F=t(82501);const Y="ComponentLib_wrapper__k2CJe",D="ComponentLib_component__QMoxH";var M=t(62989);const{Title:q}=F.A;const B=()=>(0,b.jsx)(b.Fragment,{children:E.j.map(((e,n)=>{const{groupId:t,groupName:s,components:o}=e;return(0,b.jsxs)("div",{children:[(0,b.jsx)(q,{level:3,style:{fontSize:"16px",marginTop:n>0?"20px":"0"},children:s}),(0,b.jsx)("div",{children:o.map((e=>function(e){const{title:n,type:t,Component:s,defaultProps:o}=e,r=(0,y.j)(),c=(0,i.useCallback)((()=>{r((0,f.X8)({fe_id:(0,M.Ak)(),title:n,type:t,props:o}))}),[]);return(0,b.jsx)("div",{className:Y,onClick:c,children:(0,b.jsx)("div",{className:D,children:(0,b.jsx)(s,{})})},t)}(e)))})]},t)}))});var V=t(73847),G=t(52344),Z=t(98772),Q=t(80719),X=t(84470),J=t(33389);const U="Layers_wrapper__kY3C4",$="Layers_title__L3OsU",W="Layers_selected__iZmze",ee="Layers_handler__SabZs",ne="Layers_btn__Soo0u";const te=function(){const{componentList:e,selectedId:n}=(0,C.A)(),t=(0,y.j)(),[s,o]=(0,i.useState)("");function r(e){const i=e.target.value.trim();i&&n&&t((0,f.oA)({fe_id:n,title:i}))}const c=e.map((e=>({...e,id:e.fe_id})));return(0,b.jsx)(T,{items:c,onDragEnd:function(e,n){t((0,f.pp)({oldIndex:e,newIndex:n}))},children:e.map((i=>{const{fe_id:c,title:a,isHidden:d,isLocked:l}=i,u=$,p=W,x=j()({[u]:!0,[p]:c===n});return(0,b.jsx)(K,{id:c,children:(0,b.jsxs)("div",{className:U,children:[(0,b.jsx)("div",{className:x,onClick:()=>function(i){const s=e.find((e=>e.fe_id===i));if(!s||!s.isHidden)return i!==n?(o(""),void t((0,f.RC)(i))):void o(i);V.Ay.info("\u4e0d\u80fd\u9009\u4e2d\u9690\u85cf\u7ec4\u4ef6")}(c),children:c===s?(0,b.jsx)(G.A,{value:a,onChange:r,onPressEnter:()=>o(""),onBlurCapture:()=>o("")}):a}),(0,b.jsx)("div",{className:ee,children:(0,b.jsxs)(Z.A,{direction:"horizontal",children:[(0,b.jsx)(Q.Ay,{size:"small",shape:"circle",className:d?"":ne,icon:(0,b.jsx)(X.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),type:d?"primary":"text",onClick:()=>function(e,n){t((0,f.CK)({fe_id:e,isHidden:n}))}(c,!d)}),(0,b.jsx)(Q.Ay,{size:"small",shape:"circle",className:l?"":ne,icon:(0,b.jsx)(J.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),type:l?"primary":"text",onClick:()=>function(e){t((0,f.ON)({fe_id:e}))}(c)})]})})]})},c)}))})},ie=()=>{const e=[{key:"componentsLib",label:(0,b.jsxs)("span",{children:[(0,b.jsx)(R.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),"\u7ec4\u4ef6\u5e93"]}),children:(0,b.jsx)(B,{})},{key:"layers",label:(0,b.jsxs)("span",{children:[(0,b.jsx)(z.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),"\u56fe\u5c42"]}),children:(0,b.jsx)(te,{})}];return(0,b.jsx)(O.A,{defaultActiveKey:"componentsLib",items:e})};var se=t(96395),oe=t(71124);const re=()=>(0,b.jsx)("div",{style:{textAlign:"center"},children:"\u672a\u9009\u4e2d\u7ec4\u4ef6"}),ce=()=>{const e=(0,y.j)(),{selectedComponent:n}=(0,C.A)();if(null==n)return(0,b.jsx)(re,{});const{type:t,props:i,isLocked:s,isHidden:o}=n,r=(0,E.T)(t);if(null==r)return(0,b.jsx)(re,{});const{PropComponent:c}=r;return(0,b.jsx)(c,{...i,onChange:function(t){if(null==n)return;const{fe_id:i}=n;e((0,f.Kb)({fe_id:i,props:t}))},disabled:s||o})};var ae=t(9619),de=t(89970),le=t(69141),ue=t(84689);const pe=function(){const e=(0,y.j)(),n=(0,ae.A)(),[t]=(0,le.A)();return(0,i.useEffect)((()=>{t.setFieldsValue(n)}),[n]),(0,b.jsxs)(de.A,{form:t,layout:"vertical",initialValues:n,onValuesChange:function(){e((0,ue.nq)(t.getFieldsValue()))},children:[(0,b.jsx)(de.A.Item,{label:"\u6807\u9898",name:"title",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6807\u9898"}],children:(0,b.jsx)(G.A,{placeholder:"\u8bf7\u8f93\u5165\u6807\u9898"})}),(0,b.jsx)(de.A.Item,{label:"\u63cf\u8ff0",name:"desc",children:(0,b.jsx)(G.A.TextArea,{placeholder:"\u8bf7\u8f93\u5165\u63cf\u8ff0"})}),(0,b.jsx)(de.A.Item,{label:"\u6837\u5f0f\u4ee3\u7801",name:"css",children:(0,b.jsx)(G.A.TextArea,{placeholder:"\u8bf7\u8f93\u5165\u6837\u5f0f\u4ee3\u7801"})}),(0,b.jsx)(de.A.Item,{label:"\u811a\u672c\u4ee3\u7801",name:"js",children:(0,b.jsx)(G.A.TextArea,{placeholder:"\u8bf7\u8f93\u5165\u811a\u672c\u4ee3\u7801"})})]})};var xe=function(e){return e.PROP_KEY="prop",e.SETTING_KEY="setting",e}(xe||{});const je=()=>{const[e,n]=(0,i.useState)(xe.PROP_KEY),{selectedId:t}=(0,C.A)();(0,i.useEffect)((()=>{n(t?xe.PROP_KEY:xe.SETTING_KEY)}),[t]);const s=[{key:xe.PROP_KEY,label:(0,b.jsxs)("span",{children:[(0,b.jsx)(se.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),"\u5c5e\u6027"]}),children:(0,b.jsx)(ce,{})},{key:xe.SETTING_KEY,label:(0,b.jsxs)("span",{children:[(0,b.jsx)(oe.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),"\u8bbe\u7f6e"]}),children:(0,b.jsx)(pe,{})}];return(0,b.jsx)(O.A,{activeKey:e,items:s})};var ve=t(48413);const he="EditHeader_header-wrapper__8e1hy",Ae="EditHeader_header__nO-xx",_e="EditHeader_left__Biu9L",me="EditHeader_main__xNp-F",Ce="EditHeader_right__xQSTa";var fe=t(92134),Ee=t(195),ye=t(52847),Pe=t(64273),ge=t(94039),Le=t(30165),ke=t(63715),Ne=t(80334),Ie=t(50776),be=t(50510),Te=t(3562);const we=()=>{const e=(0,y.j)(),{selectedId:n,componentList:t,selectedComponent:i,copiedComponent:s}=(0,C.A)(),{isLocked:o}=i||{},r=t.length,c=t.findIndex((e=>e.fe_id===n)),a=c<=0,d=c>=r-1;return(0,b.jsxs)(Z.A,{children:[(0,b.jsx)(Te.A,{title:"\u5220\u9664",children:(0,b.jsx)(Q.Ay,{shape:"circle",icon:(0,b.jsx)(Pe.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),onClick:function(){e((0,f.Tg)())}})}),(0,b.jsx)(Te.A,{title:"\u9690\u85cf",children:(0,b.jsx)(Q.Ay,{shape:"circle",icon:(0,b.jsx)(X.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),onClick:function(){e((0,f.CK)({fe_id:n,isHidden:!0}))}})}),(0,b.jsx)(Te.A,{title:"\u9501\u5b9a",children:(0,b.jsx)(Q.Ay,{shape:"circle",icon:(0,b.jsx)(J.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),onClick:function(){e((0,f.ON)({fe_id:n}))},type:o?"primary":"default"})})," ",(0,b.jsx)(Te.A,{title:"\u590d\u5236",children:(0,b.jsx)(Q.Ay,{shape:"circle",icon:(0,b.jsx)(ge.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),onClick:function(){e((0,f.Sk)())}})}),(0,b.jsx)(Te.A,{title:"\u7c98\u8d34",children:(0,b.jsx)(Q.Ay,{shape:"circle",icon:(0,b.jsx)(Le.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),onClick:function(){e((0,f.F7)())},disabled:null==s})}),(0,b.jsx)(Te.A,{title:"\u4e0a\u79fb",children:(0,b.jsx)(Q.Ay,{shape:"circle",icon:(0,b.jsx)(ke.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),onClick:function(){a||e((0,f.pp)({oldIndex:c,newIndex:c-1}))},disabled:a})}),(0,b.jsx)(Te.A,{title:"\u4e0b\u79fb",children:(0,b.jsx)(Q.Ay,{shape:"circle",icon:(0,b.jsx)(Ne.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),onClick:function(){d||e((0,f.pp)({oldIndex:c,newIndex:c+1}))},disabled:d})}),(0,b.jsx)(Te.A,{title:"\u64a4\u9500",children:(0,b.jsx)(Q.Ay,{shape:"circle",icon:(0,b.jsx)(Ie.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),onClick:function(){e(g.IE.undo())}})}),(0,b.jsx)(Te.A,{title:"\u91cd\u505a",children:(0,b.jsx)(Q.Ay,{shape:"circle",icon:(0,b.jsx)(be.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),onClick:function(){e(g.IE.redo())}})})]})};var Ke=t(47326),Se=t(29316),He=t(15063);const{Title:Re}=F.A,ze=()=>{const e=(0,y.j)(),{title:n}=(0,ae.A)(),[t,s]=(0,i.useState)(!1);return t?(0,b.jsx)(G.A,{value:n,onPressEnter:()=>s(!1),onBlur:()=>s(!1),onChange:function(n){const t=n.target.value.trim();t&&e((0,ue.I5)(t))}}):(0,b.jsxs)(Z.A,{children:[(0,b.jsx)(Re,{children:n}),(0,b.jsx)(Q.Ay,{icon:(0,b.jsx)(fe.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),type:"text",onClick:()=>s(!0)})]})},Oe=()=>{const{id:e}=(0,ve.g)(),{componentList:n}=(0,C.A)(),t=(0,ae.A)(),{loading:i,run:s}=(0,Ke.A)((async()=>{e&&await(0,He.Tg)(e,{...t,componentList:n})}),{manual:!0});return(0,Se.A)((()=>{s()}),[t,n],{wait:1e3}),(0,P.A)(["ctrl.s","mate.s"],(e=>{e.preventDefault(),i||s()})),(0,b.jsx)(Q.Ay,{onClick:s,loading:i,icon:i?null:(0,b.jsx)(Ee.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),children:"\u4fdd\u5b58"})},Fe=()=>{const e=(0,ve.Zp)(),{id:n}=(0,ve.g)(),{componentList:t}=(0,C.A)(),i=(0,ae.A)(),{loading:s,run:o}=(0,Ke.A)((async()=>{n&&await(0,He.Tg)(n,{...i,componentList:t,isPublished:!0})}),{manual:!0,onSuccess:()=>{V.Ay.success("\u53d1\u5e03\u6210\u529f"),e("/question/stat/".concat(n))}});return(0,b.jsx)(Q.Ay,{type:"primary",onClick:o,loading:s,children:"\u53d1\u5e03"})},Ye=()=>{const e=(0,ve.Zp)();return(0,b.jsx)("div",{className:he,children:(0,b.jsxs)("div",{className:Ae,children:[(0,b.jsx)("div",{className:_e,children:(0,b.jsxs)(Z.A,{children:[(0,b.jsx)(Q.Ay,{type:"link",icon:(0,b.jsx)(ye.A,{onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),onClick:()=>e(-1),children:"\u8fd4\u56de"}),(0,b.jsx)(ze,{})]})}),(0,b.jsx)("div",{className:me,children:(0,b.jsx)(we,{})}),(0,b.jsx)("div",{className:Ce,children:(0,b.jsxs)(Z.A,{children:[(0,b.jsx)(Oe,{}),(0,b.jsx)(Fe,{})]})})]})})};var De=t(34940);const Me=()=>{const e=(0,y.j)(),{loading:n}=(0,s.A)(),{title:t}=(0,ae.A)();return(0,De.A)("\u95ee\u5377\u7f16\u8f91 - ".concat(t)),(0,b.jsxs)("div",{className:o,children:[(0,b.jsx)(Ye,{}),(0,b.jsx)("div",{className:r,children:(0,b.jsxs)("div",{className:c,children:[(0,b.jsx)("div",{className:a,children:(0,b.jsx)(ie,{})}),(0,b.jsx)("div",{className:d,onClick:function(){e((0,f.RC)(""))},children:(0,b.jsx)("div",{className:l,children:(0,b.jsx)(H,{loading:n})})}),(0,b.jsx)("div",{className:u,children:(0,b.jsx)(je,{})})]})})]})}}}]);
//# sourceMappingURL=editPage.5227750d.chunk.js.map